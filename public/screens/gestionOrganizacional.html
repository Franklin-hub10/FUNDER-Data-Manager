<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión Organizacional</title>
    <link rel="stylesheet" href="/public/css/gestiónOrganizacional.css">
    <link rel="stylesheet" href="/public/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <!-- Navbar superior -->
 <nav class="navbar navbar-expand-lg ">
    <div class="container-fluid">
    
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item dropdown">
                    <button class="dropdown-btn" onclick="window.location.href='./home.html'">
                        <i class="bi bi-house-door-fill"></i> 
                    </button>
                    <button class="dropdown-btn" onclick="window.location.href='#'">
                        <i class="bi bi-wifi"></i>
                    </button>
                    
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-person-circle"></i> 
                    </a>
                    <ul class="dropdown-menu " aria-labelledby="userDropdown">
                        <li><a class="dropdown-item" href="#">Perfil</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#" id="logoutLink">Cerrar Sesión</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>
    <!-- Barra lateral -->
    <div class="sidebar" id="sidebar">
        <a class="navbar-brand" href="index.html">
            <img src="../../assets/images/Logo FUNDER 2021.png" alt="Logo">
        </a>
        <ul class="nav flex-column mt-4">
            <li class="nav-item">
               
            </li>
            <li class="nav-item">
                <button class="dropdown-btn">
                    <i class="bi bi-gear-fill"></i> Gestión
                </button>
                <div class="dropdown-container">
                    <a class="nav-link" href="gestionComercial.html">Gestión Comercial</a>
                    <a class="nav-link" href="gestionFinanciera.html">Gestión Financiera</a>
                    <a class="nav-link" href="gestionOrganizacional.html">Gestión Organizacional</a>
                    <a class="nav-link" href="gestionProductiva.html">Gestión Productiva</a>
                </div>
            </li>
            <li class="nav-item">
                <button class="dropdown-btn">
                    <i class="bi bi-person-badge-fill"></i> Manager
                </button>
                <div class="dropdown-container">
                    <a class="nav-link" href="roles.html">Roles</a>
                    <a class="nav-link" href="gestionUsuarios.html">Usuarios</a>
                </div>
            </li>
            <li class="nav-item">
                <button class="dropdown-btn">
                    <i class="bi bi-bar-chart-line-fill"></i> Analityca
                </button>
                <div class="dropdown-container">
                    <a class="nav-link" href="#">Dashboard</a>
                    <a class="nav-link" href="#">Sugerencias del Dx</a>
                </div>
            </li>
        </ul>
    </div>

    <div class="content">
        <div class="header">


            <div class="progress-steps">
                <div class="step" data-step="1">
                    <div class="circle">1</div>
                    <div class="label">Ficha Técnica</div>
                </div>
                <div class="step" data-step="2">
                    <div class="circle">2</div>
                    <div class="label">Ficha Diagnóstico</div>
                </div>
                <div class="step" data-step="3">
                    <div class="circle">3</div>
                    <div class="label">Gestión Organizacional</div>
                </div>
                <div class="step" data-step="4">
                    <div class="circle">4</div>
                    <div class="label">Gestión Productiva</div>
                </div>
                <div class="step" data-step="5">
                    <div class="circle">5</div>
                    <div class="label">Gestión Comercial</div>
                </div>
                <div class="step" data-step="6">
                    <div class="circle">6</div>
                    <div class="label">Gestión Financiera</div>
                </div>
                <div class="line"></div>
            </div>


            <h1>Gestión Organizacional</h1>
        </div>

        <form>
            <table>
                <tr>
                    <th>Preguntas</th>
                    <th>Diagnóstico</th>
                    <th>Medición Intermedia</th>
                    <th>Medición Final</th>
                    <th>Mejora Final</th>
                    <th>Status</th>
                </tr>
                <tr>
                    <td>¿El negocio cuenta con personería jurídica?</td>
                    <td><input type="checkbox" name="diagnostico1"></td>
                    <td><input type="checkbox" name="intermedia1"></td>
                    <td><input type="checkbox" name="final1"></td>
                    <td><input type="checkbox" name="final1.1"></td>
                    <td><input type="checkbox" name="status1"></td>
                </tr>
                <tr>
                    <td>¿El negocio cuenta con una estructura de funciones definida?</td>
                    <td><input type="checkbox" name="diagnostico2"></td>
                    <td><input type="checkbox" name="intermedia2"></td>
                    <td><input type="checkbox" name="final2"></td>
                    <td><input type="checkbox" name="final2.2"></td>
                    <td><input type="checkbox" name="status2"></td>
                </tr>
                <tr>
                    <td>¿Ha capacitado a sus empleados en este último año?</td>
                    <td><input type="checkbox" name="diagnostico3"></td>
                    <td><input type="checkbox" name="intermedia3"></td>
                    <td><input type="checkbox" name="final3"></td>
                    <td><input type="checkbox" name="final3.3"></td>
                    <td><input type="checkbox" name="status3"></td>
                </tr>
                
                <tr>
                    <td>¿El personal se encuentra afiliado al IESS?</td>
                    <td><input type="checkbox" name="diagnostico4"></td>
                    <td><input type="checkbox" name="intermedia4"></td>
                    <td><input type="checkbox" name="final4"></td>
                    <td><input type="checkbox" name="final4.4"></td>
                    <td><input type="checkbox" name="status4"></td>
                </tr>
                <tr>
                    <td>¿Cuenta con un local propio?</td>
                    <td><input type="checkbox" name="diagnostico5"></td>
                    <td><input type="checkbox" name="intermedia5"></td>
                    <td><input type="checkbox" name="final5"></td>
                    <td><input type="checkbox" name="final5.5"></td>
                    <td><input type="checkbox" name="status5"></td>
                </tr>
                <tr>
                    <td>¿Dispone de un plan de negocios?</td>
                    <td><input type="checkbox" name="diagnostico6"></td>
                    <td><input type="checkbox" name="intermedia6"></td>
                    <td><input type="checkbox" name="final6"></td>
                    <td><input type="checkbox" name="final6.6"></td>
                    <td><input type="checkbox" name="status6"></td>
                </tr>
                <tr>
                    <td>¿Tiene socios en su negocio?</td>
                    <td><input type="checkbox" name="diagnostico7"></td>
                    <td><input type="checkbox" name="intermedia7"></td>
                    <td><input type="checkbox" name="final7"></td>
                    <td><input type="checkbox" name="final7.7"></td>
                    <td><input type="checkbox" name="status7"></td>
                </tr>
                
                <tr>
                    <td>¿Usted está afiliado al seguro social?</td>
                    <td><input type="checkbox" name="diagnostico8"></td>
                    <td><input type="checkbox" name="intermedia8"></td>
                    <td><input type="checkbox" name="final8"></td>
                    <td><input type="checkbox" name="final8.8"></td>
                    <td><input type="checkbox" name="status8"></td>
                </tr>
                <tr>
                    <td>¿Su familia está asegurada al seguro social?</td>
                    <td><input type="checkbox" name="diagnostico9"></td>
                    <td><input type="checkbox" name="intermedia9"></td>
                    <td><input type="checkbox" name="final9"></td>
                    <td><input type="checkbox" name="final9.9"></td>
                    <td><input type="checkbox" name="status9"></td>
                </tr>
                <tr>
                    <td>Subtotal:</td>
                    <td><input type="text" id="subtotal_diagnostico" readonly></td>
                    <td><input type="text" id="subtotal_intermedia" readonly></td>
                    <td><input type="text" id="subtotal_final" readonly></td>
                    <td><input type="text" id="subtotal_final1" readonly></td>
                    <td><input type="text" id="status_final" readonly></td>
                    <td></td>
                </tr>
            </table>
            <button type="submit">Guardar</button>
        </form>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
         document.addEventListener('DOMContentLoaded', function () {
        
        //Barra de progreso

        const steps = document.querySelectorAll('.progress-steps .step');
    const line = document.querySelector('.progress-steps .line');

    // Función para actualizar el progreso
    function updateProgress(currentStep) {
        steps.forEach((step, index) => {
            if (index < currentStep) {
                step.classList.add('completed');
                step.classList.remove('active');
            } else if (index === currentStep) {
                step.classList.add('active');
                step.classList.remove('completed');
            } else {
                step.classList.remove('active', 'completed');
            }
        });

        const progressWidth = (currentStep / (steps.length - 1)) * 100;
        line.style.width = `${progressWidth}%`;
    }

    // Inicializar con el primer paso activo
    updateProgress(2);

    // Redirigir al hacer clic en un círculo
    steps.forEach((step, index) => {
        step.addEventListener('click', () => {
            updateProgress(index);
            switch (index) {
                case 0:
                    window.location.href = 'fichaTecnica.html';
                    break;
                case 1:
                    window.location.href = 'fichaDiagnostico.html';
                    break;
                case 2:
                    window.location.href = 'gestionOrganizacional.html';
                    break;
                case 3:
                    window.location.href = 'gestionProductiva.html';
                    break;
                case 4:
                    window.location.href = 'gestionComercial.html';
                    break;
                case 5:
                    window.location.href = 'gestionFinanciera.html';
                    break;
                default:
                    break;
            }
        });
    });

            //



        // Función para calcular los subtotales
        function calcularSubtotales() {
            // Contar checkboxes marcados en cada columna
            const diagnostico = document.querySelectorAll('input[name^="diagnostico"]:checked').length;
            const intermedia = document.querySelectorAll('input[name^="intermedia"]:checked').length;
            const final = document.querySelectorAll('input[name^="final"]:checked').length;
            const final1 = document.querySelectorAll('input[name^="final1"]:checked').length;
            const status = document.querySelectorAll('input[name^="status"]:checked').length;

            // Actualizar los campos de subtotal
            document.getElementById('subtotal_diagnostico').value = diagnostico;
            document.getElementById('subtotal_intermedia').value = intermedia;
            document.getElementById('subtotal_final').value = final;
            document.getElementById('subtotal_final1').value = final1;
            document.getElementById('status_final').value = status;
        }

        // Evento para calcular subtotales automáticamente al marcar/desmarcar un checkbox
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', calcularSubtotales);
        });

        const dropdownBtns = document.querySelectorAll('.dropdown-btn');
        const logoutLink = document.getElementById('logoutLink');

        // Manejo del menú desplegable
        dropdownBtns.forEach((btn) => {
            btn.addEventListener('click', function () {
                const container = this.nextElementSibling;
                container.classList.toggle('show');
            });
        });

        // Manejo del cierre de sesión
        logoutLink.addEventListener('click', function (event) {
            event.preventDefault(); // Evita la redirección inmediata

            // Limpia datos almacenados (si aplica)
            localStorage.clear(); // Limpia almacenamiento local
            sessionStorage.clear(); // Limpia almacenamiento de sesión

            // Redirige al usuario a la página de inicio de sesión
            window.location.href = './index.html';
        });

    });
    </script>
</body>
</html>